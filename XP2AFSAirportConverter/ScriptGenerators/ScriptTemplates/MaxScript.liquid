--                                             Generated By
-- __  ______ ____     _    _____ ____    _    _                       _    ____                          _
-- \ \/ /  _ \___ \   / \  |  ___/ ___|  / \  (_)_ __ _ __   ___  _ __| |_ / ___|___  _ ____   _____ _ __| |_ ___ _ __
--  \  /| |_) |__) | / _ \ | |_  \___ \ / _ \ | | '__| '_ \ / _ \| '__| __| |   / _ \| '_ \ \ / / _ \ '__| __/ _ \ '__|
--  /  \|  __// __/ / ___ \|  _|  ___) / ___ \| | |  | |_) | (_) | |  | |_| |__| (_) | | | \ V /  __/ |  | ||  __/ |
-- /_/\_\_|  |_____/_/   \_\_|   |____/_/   \_\_|_|  | .__/ \___/|_|   \__|\____\___/|_| |_|\_/ \___|_|   \__\___|_|
--                                                   |_|
--
-- This script is licensed under the GNU General Public License v3 https://www.gnu.org/licenses/gpl-3.0.en.html
--
-- Airport: {{AirportICAO}} {{AirportName}}
-- Generated On: {{ GeneratedOn | date:"yyyy-MM-dd HH:MM:ss UTC" }}

-- Reset the max file
resetMaxFile #noprompt

--Set units to meters. 1 unit = 1 meter
units.DisplayType = #Metric
units.MetricType = #meters
units.SystemType = #meters
units.SystemScale = 1

-- ----------------------------------------------------------------------------
-- Draw Runways
-- ----------------------------------------------------------------------------

{% assign i = 1 %}
{% for runway in Runways -%}
-- ----------------------------------------------------------------------------
-- Runway {{i}}
macros.run "Objects Shapes" "Rectangle"
Rectangle length:{{runway.Length}} width:{{runway.Width}} cornerRadius:0 pos:[0,0,0] isSelected:on
$.name = "Runway {{i}}"
select $Runway{{i}}
toolMode.coordsys #view
rotate $ (angleaxis {{runway.Angle}} [0,0,1])

$.pos.x = {{runway.X}}
$.pos.y = {{runway.Y}}

{% assign i = i | plus:1 %}

{% endfor -%}


-- ----------------------------------------------------------------------------
-- Draw Pavements
-- ----------------------------------------------------------------------------

{% assign i = 1 %}
{% for pavement in Pavements -%}
-- ----------------------------------------------------------------------------
-- Pavement {{pavement.Name}}

{% for node in pavement.Nodes -%}
{%- if node.OpenLoop -%}
sp = splineShape()
addNewSpline sp
{%- endif -%}
{%- if node.IsBezier -%}
addKnot sp 1 #bezier #curve [{{node.X}},{{node.Y}},0] [{{node.X}},{{node.Y}},0] [{{node.BezierControlX}},{{node.BezierControlY}},0]
{%- else -%}
addKnot sp 1 #corner #line [{{node.X}},{{node.Y}},0]
{%- endif -%}
{%- if node.CloseLoop -%}
close sp 1
updateShape sp
select sp
sp.name = "Pavement {{i}} {{pavement.Name}}"
{% assign i = i | plus:1 %}
{%- endif -%}
{% endfor -%}



{% endfor -%}


-- Quadify Runway
--select $Runway1
--modPanel.addModToSelection (Quadify_Mesh ()) ui:on
--$.modifiers[#Quadify_Mesh].quadsize = 16